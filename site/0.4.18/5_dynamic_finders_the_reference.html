<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at Jan 16, 2013
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20130116" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Gaedo - </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Gaedo</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2013-01-16</li>
                      
                
                    
                 <li id="projectVersion" class="pull-right">Version: 0.4.18</li>
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">about gaedo</li>
                                
      <li>
    
                          <a href="1_the_gaedo_case.html" title="the gaedo case">
          <i class="none"></i>
        the gaedo case</a>
            </li>
                  
      <li>
    
                          <a href="2_gaedo_and_collection_storage.html" title="gaedo and collection storage">
          <i class="none"></i>
        gaedo and collection storage</a>
            </li>
                  
      <li>
    
                          <a href="3_method_missing_vs_invokeLater.html" title="method missing vs invokeLater">
          <i class="none"></i>
        method missing vs invokeLater</a>
            </li>
                  
      <li>
    
                          <a href="4_compilable_queries_a_senseless_concept.html" title="compilable queries a senseless concept">
          <i class="none"></i>
        compilable queries a senseless concept</a>
            </li>
                  
      <li class="active">
    
            <a href="#"><i class="none"></i>dynamic finders the reference</a>
          </li>
                  
      <li>
    
                          <a href="6_how_to_include_gaedo_in_my_application.html" title="how to include gaedo in my application">
          <i class="none"></i>
        how to include gaedo in my application</a>
            </li>
                  
      <li>
    
                          <a href="7_graphing_queries.html" title="graphing queries">
          <i class="none"></i>
        graphing queries</a>
            </li>
                  
      <li>
    
                          <a href="8_kudos_to_all_of_you.html" title="kudos to all of you">
          <i class="none"></i>
        kudos to all of you</a>
            </li>
                  
      <li>
    
                          <a href="9_gaedo_bug_in_bouncing_queries.html" title="gaedo bug in bouncing queries">
          <i class="none"></i>
        gaedo bug in bouncing queries</a>
            </li>
                  
      <li>
    
                          <a href="10_gaedo_does_graphs.html" title="gaedo does graphs">
          <i class="none"></i>
        gaedo does graphs</a>
            </li>
                              <li class="nav-header">other infos</li>
                                
      <li>
    
                          <a href="easy_release_with_maven.html" title="easy release with maven">
          <i class="none"></i>
        easy release with maven</a>
            </li>
                  
      <li>
    
                          <a href="gaedo_in_the_wild.html" title="gaedo in the wild">
          <i class="none"></i>
        gaedo in the wild</a>
            </li>
                  
      <li>
    
                          <a href="gaedo_supports_migrations.html" title="gaedo supports migrations">
          <i class="none"></i>
        gaedo supports migrations</a>
            </li>
                  
      <li>
    
                          <a href="guice_integration_is_ready.html" title="guice integration is ready">
          <i class="none"></i>
        guice integration is ready</a>
            </li>
                  
      <li>
    
                          <a href="prevalence_in_gaedo.html" title="prevalence in gaedo">
          <i class="none"></i>
        prevalence in gaedo</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                                                                                
      <li>
    
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                                                                                            
      <li>
    
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                            <form id="search-form" action="http://www.google.com/search" method="get" >
    
  <input value="$sitesearchValue" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=search-form"></script>
          
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <p><b>mandatory disclaimer</b> We try as far as possible to make sure this article stays up-to-date with existing code. As a consequence, some modification may appear. Fortunatly, as articles are wiki pages, one may access previous versions and page history. </p><p>Well, compilable queries are cool, no problem about it. But the code is  so big ! No ?</p><h1>Dynamic finders goodness</h1><p>Dont you find it overkill to have to write</p>
<div class="source"><pre class="prettyprint linenums">    u = userService.find().matching(new QueryBuilder&lt;UserInformer&gt;() {

       @Override
       public QueryExpression createMatchingExpression(UserInformer object) {
         return object.getLogin().equalsTo(&quot;toto&quot;);
       }
    }).getFirst();
</pre></div><p>When Grails code allows you to write it as something like</p>
<div class="source"><pre class="prettyprint linenums">    u = userService.findOneWithLoginEqualsTo(&quot;toto&quot;);
</pre></div><p>Would be cool to have it working ? Well, Why are you asking that ? You have that feature ! Mmh, you think Im making fun of you, arent you ? You think that youll have to write an implementation somewhere ? Well, youre wrong. You only have to follow some rules Ill explain you below, and voila ! It simply works. </p><h1>Interface declaration</h1><p>First, you have to declare an interface extending the <tt>DynamicFinder interface for the class you're willing to build dynamic finders on. Taking back the example of compilable queries (</tt>User<tt>and</tt>Post<tt>classes), if I want to make a</tt>DynamicFinder<tt>for</tt>User`, Ill declare the interface the following way :</p>
<div class="source"><pre class="prettyprint linenums">public interface DynamicUserService extends DynamicFinder&lt;User, UserInformer&gt;,
       FinderCrudService&lt;User, UserInformer&gt; {
    public int countByLoginEqualsTo(String login);

    public User findOneWithLoginEqualsTo(String login);
}
</pre></div><p>Dont care for now about method names, Ill explain them later. Once you have this interface, how to use it ? Simple, again, supposing you already have built a back-end service, simply implementing the <tt>FinderCrudService</tt> interface for your user class :</p>
<div class="source"><pre class="prettyprint linenums">    // Creating the backEnd service is out of this article scope
    FinderCrudService&lt;User, UserInformer&gt; backEnd = (FinderCrudService&lt;User, UserInformer&gt;) TestEnvironmentProvider.create().get(Tag.class);
    // Any implementor of ServiceGenerator interface could be used, but since ServiceGeneratorImpl is our only implementor, let's use it
    ServiceGenerator generator = new ServiceGeneratorImpl();
    DynamicUserService service = (DynamicUserService) generator.generate(
         DynamicUserService.class, backEnd);
</pre></div><p>Once obtained, one can call the aforementionned methods and have results, it will work, undoubtly (or fail with an exception we hope is clear enough for you to modify your code). But how do you have to write your methods declarations ? </p><h1>Method declaration rules</h1><p>A method is made of some parts, and for all of these parts, some convention applies.  * Return type may allow in some case dynamic conversion  * A method prefix must be defined  * Then, a field name must be put with some rules  * For this field, an expression must be chosen  * Depending upon the query, a combination can be used </p><p>And finally, method parameters must match the various required values for expressions </p><div class="section"><h2>Method prefix<a name="Method_prefix"></a></h2><p>Prefix are allowed for some of the result fetching modes </p>
<table border="0" class="table table-striped">
<tr class="a">
<th>mode</th><th>prefix</th><th>return type</th><th>Notes</th></tr>
<tr class="b"><td>count</td><td>countBy</td><td>int, Integer, long, Long</td><td>Any of those types can be accepted, although integer.!MAX_VALUE can be reached without raising exceptions</td></tr>
<tr class="a"><td>getAll</td><td>findAllBy</td><td>Any Iterable sub-interface from java.util</td><td>Notice that by using another type than Iterable, Iterable loading is required, which may cause =!OutOfMemoryException= or very long code run, so, use it with care</td></tr>
<tr class="b"><td>get(start, end)</td><td>findRangeBy</td><td>Exactly like getAll, any sub-interface of iterable can be used.</td><td>Be careful : when using this query mode, there are two addintionnal parameters that must be put in method signature as the two first parameters. These two parameters must be int or Integer. in any other case, a `MethodBindingException` will be thrown.</td></tr>
<tr class="a"><td>getFirst</td><td>findOneWith</td><td>The type used for service definition, or one of its super-classes or super-interfaces</td><td> </td></tr>
</table></div><div class="section"><h2>Query expressions<a name="Query_expressions"></a></h2><p>These expressions define what were searching for </p><div class="section"><h3>Field definition<a name="Field_definition"></a></h3><p>Each time a field name is put in method declaration, its first letter is uppercased, to comply with method name conventions. As an example User login field will be put in method declaration as Login. Any field of the class declared by service or any of its super-classes or super-interfaces can be used in a dynamic finder method declaration.</p></div><div class="section"><h3>Expression<a name="Expression"></a></h3><p>Once a field name has been put, an expression must be used for this field. The usable expressions are all associated to the <tt>FieldInformer</tt> used to represent this field in our query API. As an example, for a String field (and login is such a field), the following expressions are usable (those of <tt>ObjectFieldinformer</tt> and <tt>StringFieldInformer</tt>) : </p>
<ul>
  <li>equalsTo(Object other)</li>
  <li>contains(String contained)</li>
  <li>startsWith(String start)</li>
  <li>endsWith(String end)</li>
</ul><p>Notice the method parameters types ? These types must be (or types that can be assigned to these ones) the ones in method parameters declaration at the position of the field (a more complex example will explain it all later). </p></div><div class="section"><h3>Combination<a name="Combination"></a></h3><p>Writing a dynamic finder with one field is cool, but with more than one field, its really great. For that, one can combine expressions using either Or or And. I expect their meaning to be clear enough. However, their is one restriction. Since a method name cant contain parenthesis, the combination used is always the last one.</p></div></div><div class="section"><h2>Sorting expressions<a name="Sorting_expressions"></a></h2><p>These expression define in which order the results will be returned. They are introduced in method name by the text SortBy. </p><div class="section"><h3>Field definition<a name="Field_definition"></a></h3><p>The field definition works exactly like for query expressions </p></div><div class="section"><h3>Ordering<a name="Ordering"></a></h3><p>Two ordering mode are supported : </p>
<ul>
  <li>Ascending</li>
  <li><p>Descending </p></div><div class="section"><h3>Combination<a name="Combination"></a></h3></li>
</ul><p>only one combination is supported : Then. It helps you memorize that sorting is done one after the other. </p><h1>Examples</h1><p>now, some examples to make things clear. </p></div></div><div class="section"><h2>Simple one<a name="Simple_one"></a></h2><p>The above example can be translated from</p>
<div class="source"><pre class="prettyprint linenums">User u = findOneWithLoginEqualsTo(&quot;toto&quot;);
</pre></div><p>to </p>
<div class="source"><pre class="prettyprint linenums">    User u = userService.find().matching(new QueryBuilder&lt;UserInformer&gt;() {

       @Override
       public QueryExpression createMatchingExpression(UserInformer object) {
         return object.getLogin().equalsTo(&quot;toto&quot;);
       }
    }).getFirst();
</pre></div></div><div class="section"><h2>Or example<a name="Or_example"></a></h2><p>To check if login is either toto or tata, one could write </p>
<div class="source"><pre class="prettyprint linenums">User u = findOneWithLoginEqualsToOrLoginEqualsTo(&quot;toto&quot;, &quot;tata&quot;);
</pre></div><p>or prefer the longer </p>
<div class="source"><pre class="prettyprint linenums">    User u = userService.find().matching(new QueryBuilder&lt;UserInformer&gt;() {

       @Override
       public QueryExpression createMatchingExpression(UserInformer object) {
         return Expression.or(
          object.getLogin().equalsTo(&quot;toto&quot;),
          object.getLogin().equalsTo(&quot;tata&quot;));
       }
    }).getFirst();
</pre></div></div><div class="section"><h2>Range example<a name="Range_example"></a></h2><p>To get the list of the 20 first users with logins starting with l, one can write</p>
<div class="source"><pre class="prettyprint linenums">Collection&lt;User&gt; u = findRangeByLoginEqualsTo(0,20, &quot;toto&quot;, &quot;tata&quot;);
</pre></div><p>or</p>
<div class="source"><pre class="prettyprint linenums">    Iterable&lt;User&gt; u = userService.find().matching(new QueryBuilder&lt;UserInformer&gt;() {

       @Override
       public QueryExpression createMatchingExpression(UserInformer object) {
         return object.getLogin().startsWith(&quot;l&quot;);
       }
    }).get(0,20);
</pre></div><h1>What do not works yet</h1>
<ul>
  <li>Criterias on collections</li>
  <li>Class navigation (like querying to get user which wrote a post titled Compilable queries, a senseless concept ?. Nope, you wont find me)</li>
</ul><p>But they may work in a far or near future, depending upon your will ;-)</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2013
                        <a href="www.dooapp.com">dooApp</a>.
            All Rights Reserved.      
                    
      </div>

        
        
          
    
    
                
    <div id="ohloh" class="pull-right">
      <script type="text/javascript" src="http://www.ohloh.net/p/gaedo/widgets/project_factoids.js"></script>
    </div>
        </div>
    </footer>
  </body>
</html>
