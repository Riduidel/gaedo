<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at Nov 15, 2012
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20121115" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Gaedo blueprints backed services - </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Gaedo blueprints backed services</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2012-11-15</li>
                      
                
                    
                 <li id="projectVersion" class="pull-right">Version: 0.4.2-SNAPSHOT</li>
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">about gaedo-blueprints</li>
                                
      <li class="active">
    
            <a href="#"><i class="none"></i>An introduction to gaedo graph storage</a>
          </li>
                  
      <li>
    
                          <a href="2_gaedo_generic_storage.html" title="Access to generic nodes">
          <i class="none"></i>
        Access to generic nodes</a>
            </li>
                  
      <li>
    
                          <a href="3_querying_graph.html" title="Querying a graph">
          <i class="none"></i>
        Querying a graph</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                                                              
      <li>
    
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                                                                                                              
      <li>
    
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                            <form id="search-form" action="http://www.google.com/search" method="get" >
    
  <input value="$sitesearchValue" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=search-form"></script>
          
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section"><h2>Foreword<a name="Foreword"></a></h2><p>This document tries to explain how data is to be stored when using gaedo-blueprints. Obviously, concepts regarding gaedo are supposed to be understood here (namely the distinction between managed classes - the beans that are persisted - and service classes -the objects that are used to persist those beans).</p><p>As an aside, a basic knowledge of what graphs are (and arent) could be useful.</p><p>Finally, knowing how <a class="externalLink" href="https://github.com/tinkerpop/blueprints/wiki">blueprints</a> and its specific <a class="externalLink" href="http://neo4j.org/">neo4j</a> <a class="externalLink" href="https://github.com/tinkerpop/blueprints/wiki/Neo4j-Implementation">adaptation layer</a> work is of obvious use (as theyre used in all examples and unit tests for <tt>gaedo-blueprints</tt>).</p><h1>How to store an object graph into a persistent graph ?</h1><p>A simple question, no ? Well, in fact, not so.</p><p>Lets start with a basic example  our beloved <tt>Tag</tt> class (see in <tt>gaedo-test-beans</tt>) in its first version.</p><p>If we look at that class its fields are few :</p>
<div class="source"><pre class="prettyprint linenums">public class Tag extends Identified implements Serializable {
    private static final Logger logger = Logger.getLogger(Tag.class.getName());

    private String text;

}
</pre></div></div><div class="section"><h2>Storing properties as properties<a name="Storing_properties_as_properties"></a></h2><p>We could imagine storing each of the non-static (and non-transient, of course) fields of that class as one of Tag associated <a class="externalLink" href="https://en.wikipedia.org/wiki/Vertex_(graph_theory)">vertex</a> properties. Something like <tt>text</tt> could do the trick, no ? This simple solution would lead to that graph :</p><p><img src="images/gaedo_graph_storage_1_graph_with_properties.jpg" alt="A graph where properties are stored as vertex properties" /></p><p>Well, it would immediatly raise some issues :</p>
<ol style="list-style-type: decimal">
  <li>What if two <tt>Tag</tt> share the same text ?</li>
  <li>What if <tt>Tag</tt> class had a subclass containing an other <tt>text</tt> property.</li>
</ol></div><div class="section"><h2>Storing properties as edges<a name="Storing_properties_as_edges"></a></h2><p>Both issues can be solved by changes in the storage paradigm to make it converge with some basic concepts of graph theory.</p>
<ol style="list-style-type: decimal">
  <li>Each property of an object should be stored as an <a class="externalLink" href="https://en.wikipedia.org/wiki/Edge_(geometry)">edge</a> linking the object (as edge source) to the property value.</li>
  <li>Each edge name should be built from class name and property name instead of simple property value</li>
</ol><p>Which lead to this second simple graph :</p><p><img src="images/gaedo_graph_storage_2_graph_with_relationships.jpg" alt="A graph where properties are stored as edges linking vertices representing property owner and property value" /></p><p>Well, this second graph is better by multiple aspects. Indeed, as relationships are named from class (implementation uses full class name, instead of this tutorial-level one which uses simple class name) and property name, there is now only one relationship linking a <tt>Tag</tt> to its <tt>text</tt>, and its named <tt>Tag:text</tt>. which is a good name. Furthermore, any <tt>Tag</tt> using the <tt>&quot;tag text&quot;</tt> text will be linked to this very vertex. Which is undoubtly a very ood thing if we plan to find all <tt>Tag</tt>instances using this text (dont worry, queries will have their very own documentation).</p><p>But</p><p>What if I want to use the <tt>&quot;3&quot;</tt> text ? Will instances be linked to the vertex that also represent the <tt>3</tt> integer number and the <tt>3.0</tt> float number ? That question troubled me a lot.</p><p>And what if I want to use the <tt>&quot;Tag:1&quot;</tt> text ? That object is clearly not the same that <tt>Tag:1</tt> is, no ? But, according to previous definition, they would be stored using the same vertex, which is now visibly unthinkable.</p></div><div class="section"><h2>Adding type informations<a name="Adding_type_informations"></a></h2><p>So I introduce here some supplementary properties (which will make that graph even more semantic-a-like)</p><p><img src="images/gaedo_graph_storage_3_graph_with_relationships_and_semantic_types.jpg" alt="A graph that make gaedo very similar to semantic web" /></p><p>These properties are kinda special, let me explain them a little more</p>
<ul>
  <li><b>kind</b> can be <tt>uri</tt>, for vertices linked to others, <tt>bnode</tt> for vertices without specifc ids, and <tt>literal</tt> for all those literal values you know and love (like strings, numbers, dates, and so on). That <tt>kind</tt> property is defined on all vertices gaedo access.</li>
  <li><b>type</b> is defined only on vertices of <tt>literal</tt> <tt>kind</tt>. It contains a definition of the type used for that value. Notice that, instead of using standard Java type, I try to use semantic visions of those types. As a consequence, a Java string will be represented by a <tt>xsd:string</tt>.</li>
</ul><p>Were quite at the end of that introduction to gaedo graph storage. Except for one thing  a <tt>Tag</tt> is a <tt>Tag</tt>, but its also an instance of all its superclasses (like <tt>Identified</tt>, as an example). Suppose, as an example, were looking for all <tt>Identified</tt> instances which <tt>id</tt> is greater than 3. How could we do ? We could explore the java classes extending <tt>Identified</tt> (as an example using <a class="externalLink" href="http://code.google.com/p/reflections/">reflections</a>) then search all of their instances. But, admit it, its clearly not oriented towards graph navigation : this kind of process would be like taking some nodes quite at random to examine them.</p></div><div class="section"><h2>Adding links to classes<a name="Adding_links_to_classes"></a></h2><p>This leads to the effective implementation exposed below</p><p><img src="images/gaedo_graph_storage_4_real_world_tag_graph.png" alt="A real-world graph complete with links to classes and to id" /></p><p>You can see that each object is linked to all of its classes using the <tt>Object:classes</tt> edge. Furthermore, it is linked to its effective class using the <tt>Object:type</tt> edge. One should notice that these edge exist, even if the object expose absolutely no property regarding its classes (which is the case of the Tag class).</p><p>So, to your mind, is it possible to recreate the <tt>Tag</tt> object this graph represents ?</p><p>We know some things :</p>
<ul>
  <li>its <tt>com.dooapp.gaedo.test.beans.Tag:text</tt> is a string which value is <tt>&quot;tag text&quot;</tt></li>
  <li>its <tt>com.dooapp.gaedo.test.beans.Identified:id</tt> is a long which value is <tt>1</tt></li>
  <li>its <tt>java.lang.Object:classes</tt> are <tt>Identified</tt>, <tt>Serializable</tt> and <tt>Tag</tt></li>
  <li>and its <tt>java.lang.Object:type</tt> is also <tt>Tag</tt></li>
</ul><p>which makes it a Tag with id <tt>1</tt> and text <tt>tag text</tt>.</p><p>One may however ask where is the <tt>Tag#rendering</tt> property. It is easy, it is missing. And it is missing because its value is null, which we <b>never</b> represent.</p><h1>Conclusion</h1><p>As one can see, the implementation rendered is conceptually similar to the one a <tt>SaigGraph</tt> can produce, and for a good reason : all objects stored by gaedo in graphc an be exported as RDF statements, like <tt>GraphPostFinderServiceTest#allowExport()</tt> test method clearly shows.</p><p>But, as the documentation about queries explain, it is absolutely not the only advantage of that persistence strategy.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2012
                        <a href="www.dooapp.com">dooApp</a>.
            All Rights Reserved.      
                    
      </div>

        
        
          
    
    
                
    <div id="ohloh" class="pull-right">
      <script type="text/javascript" src="http://www.ohloh.net/p/gaedo/widgets/project_factoids.js"></script>
    </div>
        </div>
    </footer>
  </body>
</html>
